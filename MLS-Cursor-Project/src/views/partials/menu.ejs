<div class="side-menu" id="sideMenu">
    <div class="logo">
        <img src="https://images.leadconnectorhq.com/image/f_webp/q_80/r_1200/u_https://assets.cdn.filesafe.space/3InRCEDtojc1F8qlDEgE/media/669c274a53a603b1c7ee7f3c.png" alt="The Lab Logo" class="lab-logo">
    </div>

    <div class="menu-items">
        <a href="/" class="menu-item <%= locals.view === 'home' ? 'active' : '' %>">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
            </svg>
            <span class="menu-text">Home</span>
        </a>

        <div class="menu-group">
            <div class="menu-label">Data Views</div>
            <a href="/cards" class="menu-item <%= locals.view === 'cards' ? 'active' : '' %>">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"/>
                </svg>
                <span class="menu-text">Cards</span>
            </a>
            <a href="/list" class="menu-item <%= locals.view === 'list' ? 'active' : '' %>">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"/>
                </svg>
                <span class="menu-text">List</span>
            </a>
            <a href="/map" class="menu-item <%= locals.view === 'map' ? 'active' : '' %>">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"/>
                </svg>
                <span class="menu-text">Map</span>
            </a>
        </div>

        <div class="menu-group">
            <% if (isAuthenticated) { %>
                <a href="/auth/logout" class="menu-item menu-item-logout">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
                    </svg>
                    <span class="menu-text">Logout</span>
                </a>
            <% } %>
        </div>
    </div>
</div>

<button class="menu-toggle" id="menuToggle">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="menu-icon menu-icon-left">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
    </svg>
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" class="menu-icon menu-icon-right">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
    </svg>
</button>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const sideMenu = document.getElementById('sideMenu');
    const menuToggle = document.getElementById('menuToggle');
    const mainContent = document.querySelector('.main-content');
    
    // Get initial state from localStorage or default to open
    let menuState = localStorage.getItem('menuState') === 'closed' ? false : true;
    
    function updateMenuState() {
        sideMenu.classList.toggle('collapsed', !menuState);
        menuToggle.classList.toggle('collapsed', !menuState);
        if (mainContent) {
            mainContent.classList.toggle('menu-collapsed', !menuState);
        }
    }
    
    // Set initial state
    updateMenuState();
    
    menuToggle.addEventListener('click', function() {
        menuState = !menuState;
        updateMenuState();
        localStorage.setItem('menuState', menuState ? 'open' : 'closed');
    });
});
</script>